=QUERY(ARRAYFORMULA({FLATTEN(SPLIT(A:A," ")), LEN(FLATTEN(SPLIT(A:A," "))) }),"Select Col1, count(Col1) where Col2 > 3 and Col1 is not null AND Col1 <> '#VALUE!' group by Col1 order by count(Col1) desc label Col1 'Word', count(Col1) '#ocurrences'") 


////////// **Purpose:** //////////

This Google Sheets formula extracts all words from a range of cells (A:A in this case), counts the occurrences of each word that is longer than 3 characters, and presents the results in descending order of frequency.

////////// **Explanation:** //////////

SPLIT(A:A," "): This part takes the text content from cells A:A and splits it into individual words, using a space (" ") as the delimiter.

FLATTEN(...): The FLATTEN function then takes the list of word lists generated by SPLIT and transforms it into a single column of words.

LEN(FLATTEN(SPLIT(A:A," "))): This part calculates the length of each word in the flattened list created in step 2.

ARRAYFORMULA({..., ...}): The ARRAYFORMULA function is used to perform the word splitting and length calculation on the entire range of cells (A:A) at once. The curly braces {} are used to create a virtual table with two columns: the words themselves and their corresponding lengths.

QUERY(..., "Select Col1, count(Col1) ..."): The QUERY function analyzes the data generated by the ARRAYFORMULA.

Select Col1, count(Col1) instructs it to retrieve each unique word (Col1) and the number of times it appears.
where Col2 > 3 and Col1 is not null AND Col1 <> '#VALUE!': This filters the results to include only words that are longer than 3 characters, are not blank, and are not errors (#VALUE!).
group by Col1: This groups the results so that the count (count(Col1)) corresponds to each unique word.

order by count(Col1) desc: This arranges the results in descending order based on the word count, with the most frequent word at the top.

label Col1 'Word': This assigns a more descriptive label, "Word", to the column containing the unique words in the final output.

In summary: This formula efficiently processes a range of cells, extracts individual words, filters based on length, counts their occurrences, and presents the results in a clear and organized manner.
